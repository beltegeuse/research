{% extends "index.html" %}
{% import "macros.html" as macros %}

{% block content %}
<section id="publications">
		<div class="container">
			<div class="article-container">
				<h1>{{ page.title | title }}</h1>
				<span class="pub-authors">
					<p>
					{% for author in page.extra.authors %}
						{{macros::one_author_with_link(author=author, websites=config.extra.websites) | trim }}, {{ author.institution }} <br/>
					{% endfor %}
					{% if page.extra is containing("join_first") %}
						(join first authors)
					{% endif %}
					</p>

					<img src="{{ get_url(path="/publication/" ~ page.extra.image) }}" class="pub-banner" itemprop="image">

					<h3>Abstract</h3>
					<p class="pub-abstract" > {{ page.extra.abstract | markdown(inline=true) | safe }} </p>

					<h3>Downloads</h3>

					{% set dls = page.extra.download | group_by(attribute="type") %}
					{% if dls.project %}
					<h4>Project page</h4>
					<ul class="fa-ul">
					<li>
						<span class="fa-li">
							<i class="fas fa-external-link-alt"></i>
						</span>
						<a href={{ dls.project[0].url }}>External project website</a>
					</li>
					</ul>
					{% endif %}

					{% if dls.doi or dls.paper %}
					<h4>Publication</h4>
					<ul class="fa-ul">
						{% if dls.paper %}
						<li>
							<span class="fa-li">
								<i class="fas fa-file-pdf"></i>
							</span>
							<a href={{ dls.paper[0].url }}>Paper (author's version), PDF</a>
						</li>
						{% endif %}
						{% if dls.doi %}
						<li><span class="fa-li"><i class="fas fa-atlas"></i></span>
							<a href="{{ dls.doi[0].url }}">Publisher's official version</a> â€“ external link, may require a subscription
						  </li>
						{% endif %}
					</ul>
					{% endif %}

					{% if dls.code %}
					<h4>Code & Data</h4>
					<ul class="fa-ul">
						<li>
							<span class="fa-li">
								<i class="fab fa-github"></i>
							</span>
							<a href={{ dls.code[0].url }}>Public repository</a>
						</li>
					</ul>
					{% endif %}

					{% if dls.additional %}
					{% for add in dls.additional %}
					<h4>Additional</h4>
					<ul class="fa-ul">
						<li>
							<span class="fa-li">
								<i class="far fa-plus-square"></i>
							</span>
							<a href={{ add.url }}>{{add.desc}}</a>
						</li>
					</ul>	
					{% endfor %}
					{% endif %}

					{{ page.content | markdown | safe }}
					
					<h3>Cite</h3>
					{{ macros::authors_with_link(authors=page.extra.authors, websites=config.extra.websites, final=" and ")}}. <b>{{ page.title | title }}</b>, {{ page.extra.publication | markdown(inline=true) | safe }}
					
					{% if page.extra.bibtex %}
					<div>
						<pre class="bibtex-box">{{ page.extra.bibtex | safe }}</pre>
					</div>
					{% endif %}

				</div>
			</div>
		</div>
</section>
{% endblock content %}